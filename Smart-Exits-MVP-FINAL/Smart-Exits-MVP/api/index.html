<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<title>Smart Exits Dashboard</title>
<style>
    body { font-family: Arial; padding: 20px; background: #f5f5f5; }
    .card { background: white; padding: 20px; margin-bottom: 20px; border-radius: 12px; box-shadow: 0 0 10px #ddd; }
    h2 { margin-top: 0; }
    button { padding: 10px 20px; border:none; background:#007bff; color:white; border-radius:6px; cursor:pointer; }
</style>
</head>

<body>

<h1>ğŸ“Š Smart Exits â€“ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø£ÙˆÙ„ÙŠ</h1>

<div id="authority" class="card"></div>
<div id="driver" class="card"></div>

<script>
async function loadData() {
    const res = await fetch("/api/smart_exits");
    const data = await res.json();

    // ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø±ÙˆØ±
    document.getElementById("authority").innerHTML = `
        <h2>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… â€“ Ø§Ù„Ù…Ø±ÙˆØ±</h2>
        <p><strong>Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡:</strong> ${data.traffic_authority_dashboard.alert}</p>
        <p><strong>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡:</strong> ${data.traffic_authority_dashboard.recommended_action}</p>
        <p><strong>Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:</strong> ${data.predicted_congestion.reason}</p>
        <p><strong>Ø§Ù„ØªØ¯ÙÙ‚ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹:</strong> ${data.traffic_authority_dashboard.predicted_traffic_stats.impact_if_closed}</p>
        <button onclick="alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø£Ù…Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ ğŸš§')">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥ØºÙ„Ø§Ù‚</button>
    `;

    // ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    const n = data.driver_app_view.notification;
    document.getElementById("driver").innerHTML = `
        <h2>ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… â€“ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</h2>
        <p><strong>${n.title}</strong></p>
        <p>${n.details}</p>
        <p><strong>ÙˆÙ‚Øª ÙˆØµÙˆÙ„Ùƒ Ù„Ù„Ù…Ø®Ø±Ø¬:</strong> ${n.impact_on_route.your_eta_to_exit}</p>
        <p><strong>Ù…Ø¯Ø© Ø§Ù„Ø±Ø­Ù„Ø© Ù„Ùˆ Ø§Ø³ØªÙ…Ø±ÙŠØª:</strong> ${n.impact_on_route.expected_total_trip_time_if_continue}</p>

        <h3>Ø§Ù„Ø·Ø±Ù‚ Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø©:</h3>
        <ul>
            ${n.impact_on_route.recommended_alternatives
                .map(r => `<li>${r.route} â€“ ${r.estimated_time}</li>`)
                .join("")}
        </ul>

        <button onclick="alert('Ø¬Ø§Ø±ÙŠ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø£Ø³Ø±Ø¹ ğŸš—ğŸ’¨')">
            Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡
        </button>
    `;
}

loadData();
</script>

</body>
</html>
